<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CryptoShop - Track & Trade Cryptos</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
    <style>
        body { font-family: Arial, sans-serif; background: #f8f9fa; color: #333; margin: 0; padding: 0; }
        header { background: #007bff; color: white; padding: 20px; text-align: center; }
        .container { max-width: 1200px; margin: 20px auto; padding: 20px; background: white; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .crypto-list { display: flex; justify-content: space-between; }
        .column { width: 48%; }
        .crypto-item { padding: 15px; margin: 10px 0; border: 1px solid #ddd; border-radius: 5px; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; }
        .gainer { border-left: 5px solid #28a745; }
        .loser { border-left: 5px solid #dc3545; }
        .prediction { font-size: 0.9em; color: #666; }
        .buy-btn { background: #28a745; color: white; padding: 8px 12px; border: none; border-radius: 3px; cursor: pointer; text-decoration: none; display: inline-block; margin-top: 10px; }
        .chart { margin: 20px 0; }
        .ai-chat { position: fixed; bottom: 20px; right: 20px; width: 300px; background: white; border: 1px solid #ddd; border-radius: 8px; padding: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); display: none; }
        .risk-meter { display: flex; align-items: center; margin-top: 5px; }
        .risk-bar { width: 100px; height: 10px; background: #ddd; margin-left: 10px; }
        .risk-fill { height: 100%; background: linear-gradient(to right, green, yellow, red); }
        footer { text-align: center; padding: 20px; background: #f8f9fa; font-size: 0.9em; }
        .loading { text-align: center; font-style: italic; color: #666; }

        /* Mobile Responsiveness */
        @media (max-width: 768px) {
            .crypto-list { flex-direction: column; }
            .column { width: 100%; margin-bottom: 20px; }
            .crypto-item { flex-direction: column; align-items: flex-start; }
            .buy-btn { width: 100%; text-align: center; }
            .ai-chat { width: 90%; right: 5%; bottom: 10px; }
            header h1 { font-size: 1.5em; }
            .container { padding: 10px; }
            .chart canvas { max-width: 100%; height: auto; }
        }
    </style>
</head>
<body>
    <header>
        <h1><i class="fas fa-shopping-cart"></i> CryptoShop</h1>
        <p>Track gains, predict futures, and buy cryptos instantly. (Data updates every minute)</p>
    </header>
    <div class="container">
        <div class="crypto-list">
            <div class="column">
                <h2>Top Gainers</h2>
                <div id="gainers"><p class="loading">Loading data...</p></div>
            </div>
            <div class="column">
                <h2>Top Losers</h2>
                <div id="losers"><p class="loading">Loading data...</p></div>
            </div>
        </div>
        <div class="chart">
            <h3>Price Trend Example (Bitcoin - Last 7 Days)</h3>
            <canvas id="priceChart"></canvas>
        </div>
        <button onclick="toggleChat()">Ask AI Predictor</button>
        <div id="ai-chat" class="ai-chat">
            <h4>AI Chatbot</h4>
            <p>Ask about predictions (e.g., "Will Ethereum rise?")</p>
            <input id="chat-input" type="text" placeholder="Type your question...">
            <button onclick="aiResponse()">Send</button>
            <p id="chat-response"></p>
        </div>
    </div>
    <footer>
        <p>Disclaimer: Cryptocurrency investments are volatile. This is not financial advice. Data from CoinGecko API. Always do your own research.</p>
    </footer>

    <script>
        let cryptos = [];
        let btcHistory = [];

        // Fetch real data from CoinGecko
        async function fetchCryptos() {
            try {
                const response = await fetch('https://api.coingecko.com/api/v3/coins/markets?vs_currency=usd&order=market_cap_desc&per_page=10&page=1&sparkline=false');
                const data = await response.json();
                cryptos = data.map(c => ({
                    name: c.name,
                    symbol: c.symbol.toUpperCase(),
                    price: c.current_price,
                    change: c.price_change_percentage_24h,
                    volume: c.total_volume,
                    risk: Math.min(100, Math.abs(c.price_change_percentage_24h) * 2) // Mock risk based on volatility
                }));
                renderCryptos();
            } catch (error) {
                console.error('Error fetching crypto data:', error);
                document.getElementById('gainers').innerHTML = '<p>Error loading data. Check internet or console.</p>';
                document.getElementById('losers').innerHTML = '<p>Error loading data. Check internet or console.</p>';
            }
        }

        // Fetch Bitcoin history for chart
        async function fetchBtcHistory() {
            try {
                const response = await fetch('https://api.coingecko.com/api/v3/coins/bitcoin/market_chart?vs_currency=usd&days=7');
                const data = await response.json();
                btcHistory = data.prices.map(p => ({ x: new Date(p[0]), y: p[1] }));
                renderChart();
            } catch (error) {
                console.error('Error fetching BTC history:', error);
                document.getElementById('priceChart').getContext('2d').canvas.style.display = 'none';
                document.querySelector('.chart h3').textContent = 'Chart unavailable - check console for errors.';
            }
        }

        // Render crypto list with predictions
        function renderCryptos() {
            const gainers = cryptos.filter(c => c.change > 0).sort((a, b) => b.change - a.change).slice(0, 5);
            const losers = cryptos.filter(c => c.change < 0).sort((a, b) => a.change - b.change).slice(0, 5);
            
            document.getElementById('gainers').innerHTML = gainers.map(c => {
                const shortPred = c.change > 0 ? `+${(c.change * 0.5).toFixed(1)}%` : `-${Math.abs(c.change * 0.3).toFixed(1)}%`;
                const medPred = `+${(c.change * 1.5).toFixed(1)}%`;
                const longPred = `+${(c.change * 3).toFixed(1)}%`;
                const potentialRaise = (1000 * parseFloat(shortPred.replace('%','')) / 100).toFixed(2);
                return `
                    <div class="crypto-item gainer">
                        <div>
                            <h4>${c.name} (${c.symbol})</h4>
                            <p>Price: $${c.price.toFixed(2)} | Change: +${c.change.toFixed(2)}% | Volume: $${c.volume.toLocaleString()}</p>
                            <div class="prediction">Predictions: Short: ${shortPred}, Med: ${medPred}, Long: ${longPred}</div>
                            <div class="risk-meter">Risk: <div class="risk-bar"><div class="risk-fill" style="width: ${c.risk}%"></div></div></div>
                            <p>Potential Raise (on $1000): $${potentialRaise} (Short-term)</p>
                        </div>
                        <a href="https://www.binance.com/en/buy-sell-crypto?crypto=${c.symbol}&fiat=USD" target="_blank" class="buy-btn">Buy on Binance</a>
                    </div>
                `;
            }).join('');
            
            document.getElementById('losers').innerHTML = losers.map(c => {
                const shortPred = c.change > 0 ? `+${(c.change * 0.5).toFixed(1)}%` : `-${Math.abs(c.change * 0.3).toFixed(1)}%`;
                const medPred = `+${(c.change * 1.5).toFixed(1)}%`;
                const longPred = `+${(c.change * 3).toFixed(1)}%`;
                const potentialRaise = (1000 * parseFloat(shortPred.replace('%','')) / 100).toFixed(2);
                return `
                    <div class="crypto-item loser">
                        <div>
                            <h4>${c.name} (${c.symbol})</h4>
                            <p>Price: $${c.price.toFixed(2)} | Change: ${c.change.toFixed(2)}% | Volume: $${c.volume.toLocaleString()}</p>
                            <div class="prediction">Predictions: Short: ${shortPred}, Med: ${medPred}, Long: ${longPred}</div>
                            <div class="risk-meter">Risk: <div class="risk-bar"><div class="risk-fill" style="width: ${c.risk}%"></div></div></div>
                            <p>Potential Raise (on $1000): $${potentialRaise} (Short-term)</p>
                        </div>
                        <a href="https://www.coinbase.com/price/${c.symbol.toLowerCase()}" target="_blank" class="buy-btn">Buy on Coinbase</a>
                    </div>
                `;
            }).join('');
        }

        // Render chart
        function renderChart() {
            const ctx = document.getElementById('priceChart').getContext('2d');
            new Chart(ctx, {
                type: 'line',
                data: {
                    datasets: [{
                        label: 'Bitcoin Price (USD)',
                        data: btcHistory,
                        borderColor: 'rgba(75, 192, 192, 1)',
                        fill: false
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        x: { type: 'time', time: { unit: 'day' } }
                    }
                }
            });
        }

        // AI Chat (mock, tied to real data)
        function toggleChat() {
            document.getElementById('ai-chat').style.display = 'block';
        }
        function aiResponse() {
            const input = document.getElementById('chat-input').value.toLowerCase();
            let response = "Analyzing real-time trends... ";
            const btc = cryptos.find(c => c.symbol === 'BTC');
            if (btc) {
                if (input.includes('bitcoin')) response += `Bitcoin is at $${btc.price.toFixed(2)} with ${btc.change.toFixed(2)}% change. Predicted short-term: ${btc.change > 0 ? 'rise' : 'drop'} of ${(Math.abs(btc.change) * 0.5).toFixed(1)}%.`;
                else response += "Based on current data, top gainers like " + (cryptos.filter(c => c.change > 0)[0]?.name || 'N/A') + " show positive momentum.";
            } else {
                response += "Data loading... Try again.";
            }
            document.getElementById('chat-response').textContent = response;
        }

        // Initial load and auto-refresh
        fetchCryptos();
        fetchBtcHistory();
        setInterval(fetchCryptos, 60000); // Update every 60 seconds
    </script>
</body>
</html>
